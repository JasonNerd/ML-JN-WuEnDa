# 异常检测(Anomaly Detection)
这一概念或者关于异常检测这一系列问题的方法系列来源于工业品制造中，想想你生产一批次的产品m个，对于每个产品x_i，有d个指标可以量化产品的质量，假设现在生产了一个新的该产品，测得这d个量化指标，那么如何判断这个产品是不是合格呢或者是不是不合格呢？

假设d=2, 将已知的m个数据绘制在坐标轴上, 同时也把新的数据点绘制在图中
![](http://www.ai-start.com/ml2014/images/65afdea865d50cba12d4f7674d599de5.png)
那么，一个数据点落在蓝色圈内的概率很大，是合格品，落在圈外的概率很低，一般情况下不会发生，因此以很大概率判断这是个异常品。

异常检测主要用来识别欺骗。例如在线采集而来的有关用户的数据，一个特征向量中可能会包含如：用户多久登录一次，访问过的页面，在论坛发布的帖子数量，甚至是打字速度等。尝试根据这些特征构建一个模型，可以用这个模型来识别那些不符合该模式的用户。

再一个例子是检测一个数据中心，特征可能包含：内存使用情况，被访问的磁盘数量，CPU的负载，网络的通信量等。根据这些特征可以构建一个模型，用来判断某些计算机是不是有可能出错了。

## 高斯分布
高斯分布或者正态分布，上述问题描述了一个具有两个量化指标的产品检测问题，这两个指标相互独立，各自都满足正态分布，这样的检测类似于检测指标是否落在置信区间内。为了形式化的定义这样的异常检测算法，我们有：
![](https://files.mdnice.com/user/35698/5d82dcec-d4f2-4f6f-b564-3a5e1f777502.png)

算法流程
![](https://files.mdnice.com/user/35698/4f5d66cc-8881-4eba-a4fc-ba8069279948.png)

算法为每个特征建立了高斯分布，并将评估函数记为他们的积$p(x)$，用$p(x)<\epsilon$时就表明$x$属于异常值。当特征数量为2，特征间没有相关性时，它是一个钟形图像。

## 异常检测和监督学习的区别
异常检测某种角度上似乎与监督学习十分类似，也即已知的样品假定都是正品，没有残次品，需要将新的样本分类，也即是不是正品。但他们使用的方法和场景大有不同，监督学习适用于能够获取充足量的不同类的样本，例如垃圾邮件识别，我们可以得到大量的垃圾邮件用于学习，通常方法是使用对率回归、神经网络、支持向量机等等算法，他们都是迭代算法，试图得到一个决策边界。

异常检测则面对的是这样的场景，在通常情况下，样本总是正品（阴性），出现残次品的情况很少，因而无法学习到残次品的特征，转而对正品的特征进行建模，主要依据（多元）正态分布以及置信区间检验等等的数学基础

|异常检测|监督学习|
|:--|:--|
|非常少量的正向类（异常数据）, 大量的负向类|同时有大量的正向类和负向类|
|许多不同种类的异常，非常难根据非常 少量的正向类数据来训练算法。|有足够多的正向类实例，足够用于训练 算法，未来遇到的正向类实例可能与训练集中的非常近似。|
|未来遇到的异常可能与已掌握的异常、非常的不同。例如： 欺诈行为检测 生产（例如飞机引擎）检测数据中心的计算机运行状况|	例如：邮件过滤器 天气预报 肿瘤分类|

## 特征的设计与选择
异常检测假设特征符合高斯分布，如果数据的分布不是高斯分布，异常检测算法也能够工作，但是最好还是将数据转换成高斯分布，例如

![](http://www.ai-start.com/ml2014/images/0990d6b7a5ab3c0036f42083fe2718c6.jpg)

## 使用多元高斯分布
协方差矩阵表示特征间的相关性
![](https://files.mdnice.com/user/35698/024b7528-2244-4466-bb6b-8c74976d1883.png)

1. 是一个一般的高斯分布模型
2. 通过协方差矩阵，令特征1拥有较小的偏差，同时保持特征2的偏差
3. 通过协方差矩阵，令特征2拥有较大的偏差，同时保持特征1的偏差
4. 通过协方差矩阵，在不改变两个特征的原有偏差的基础上，增加两者之间的正相关性
5. 通过协方差矩阵，在不改变两个特征的原有偏差的基础上，增加两者之间的负相关性<br>
   ![](http://www.ai-start.com/ml2014/images/29df906704d254f18e92a63173dd51e7.jpg)

